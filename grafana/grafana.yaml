version: 3.8
services:
  grafana:
    image: grafana/grafana:master
       networks:
      - traefik-private
    deploy:
      labels:
        - traefik.enable=true
        - traefik.http.services.grafana.loadbalancer.server.port=80
        - traefik.http.routers.grafana.entrypoints=websecure
        - traefik.http.routers.grafana.tls=true
        - traefik.http.routers.grafana.tls.certresolver=le
        - traefik.http.routers.grafana.rule=Host(`grafana.icestation.is`)
        - traefik.docker.network=traefik-private
    volumes:
      - /swarm/grafana/var/lib/grafana:/var/lib/grafana
      - /swarm/grafana/etc/grafana/grafana.ini:/etc/grafana/grafana.ini
      - /swarm/grafana/etc/grafana/provisioning/datasources:/etc/grafana/provisioning/datsources
